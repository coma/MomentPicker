!function(a){var b="MomentPicker";a.fn[b]=function(c){var d=a(this).data(b);if(d)return d;var e={date:moment().startOf("day")};return this.each(function(){var d,f=a.extend({},e,c),g=f.date,h=g.clone(),i=a(this),j=0;i.html(['<div class="header">','<a class="prev"></a>','<a class="current"></a>','<a class="next"></a>',"</div>",'<div class="body"></div>'].join(""));var k=i.children("div.header"),l=i.children("div.body"),m=k.children("a.next"),n=k.children("a.prev"),o=k.children("a.current"),p=function(){return!1},q=p,r=p,s=p,t=p,u=p,v=p,w=p,x=p;f.hasOwnProperty("min")&&!function(){if(f.min instanceof Function)w=f.min;else{var a=moment(f.min);moment.isMoment(a)&&(a.startOf("day"),w=function(){return a.clone()})}u=function(a){return a<w().year()},s=function(a){return a.clone().startOf("month")<w().startOf("month")},q=function(a){return a<w()}}(),f.hasOwnProperty("max")&&!function(){if(f.max instanceof Function)x=f.max;else{var a=moment(f.max);moment.isMoment(a)&&(a.startOf("day"),x=function(){return a.clone()})}v=function(a){return a>x().year()},t=function(a){return a.clone().endOf("month")>x().endOf("month")},r=function(a){return a>x()}}();var y=function(b){var c=a.Event(b);c.api=d,i.trigger(c)},z=function(a){return!u(a)&&!v(a)},A=function(a){return!q(a)&&!r(a)},B=function(a){return!s(a)&&!t(a)},C=function(){if(arguments.length>0){var a=moment(arguments[0]);return moment.isMoment(a)&&(a.startOf("day"),A(a)&&(h=a,y("pick"),g=h.clone(),I())),d}return h.clone()},D=function(){var a=g.year(),b=a+12,c="";for(o.text(a+" - "+(b-1));b>a;){var d=a!==h.year()?[]:["current"],e=z(a)?"a":"span";c+="<"+e+' data-year="'+a+'" class="'+d.join(" ")+'">'+a+"</"+e+">",a++}l.html(c),y("renderYears")},E=function(){var a=g.clone().startOf("y"),b=a.clone().add("M",12),c="";for(o.text(a.year());b>a;){var d=a.format("M-YYYY")!==h.format("M-YYYY")?[]:["current"],e=B(a)?"a":"span";c+="<"+e+' data-month="'+a.format("M-YYYY")+'" class="'+d.join(" ")+'">'+a.format("MMM")+"</"+e+">",a.add("M",1)}l.html(c),y("renderMonths")},F=function(){var a=g.clone().startOf("w"),b=a.clone().add("w",1),c='<div class="week">';for(o.text(g.format("MMMM YYYY"));b>a;)c+="<span>"+a.format("ddd")+"</span>",a.add("d",1);c+="</div>",a=g.clone().startOf("M").startOf("w"),b=a.clone().add("d",42),c+='<div class="month">';for(var d=!1;b>a;){var e=a.format("D-M-YYYY")!==h.format("D-M-YYYY")?[]:["current"],f=A(a)?"a":"span";a.month()!==g.month()?e.push(d?"next":"prev"):d=!0,c+="<"+f+' data-day="'+a.format("D-M-YYYY")+'" class="'+e.join(" ")+'">'+a.date()+"</"+f+">",a.add("d",1)}c+="</div>",l.html(c),y("renderDays")},G=[{years:12},{years:1},{months:1}],H=[D,E,F],I=function(){arguments.length>0&&(j=arguments[0]),H[j](),y("render")};m.click(function(){g.add(G[j]),I()}),n.click(function(){g.subtract(G[j]),I()}),o.click(function(){I(Math.max(0,--j))}),l.on("click","a[data-year]",function(){g.year(a(this).data("year")),I(1)}),l.on("click","a[data-month]",function(){var b=moment(a(this).data("month"),"M-YYYY");g.month(b.month()).year(b.year()),I(2)}),l.on("click","a[data-day]",function(){C(moment(a(this).data("day"),"D-M-YYYY"))}),d={val:C,renderYears:function(){I(0)},renderMonths:function(){I(1)},renderDays:function(){I(2)}},i.data(b,d),y("ready"),I()})}}(jQuery);
